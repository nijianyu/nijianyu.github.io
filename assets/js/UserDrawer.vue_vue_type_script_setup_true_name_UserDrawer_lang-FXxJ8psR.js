import{a5 as Q,a6 as W,d as S,ad as F,p as $,$ as X,q as D,ae as N,af as j,l as Z,r,c as k,o as g,b as l,a as p,g as L,O as z,P as A,w as s,F as H,ag as K,v as P,i as y,J as Y,u as O,ah as ee,m as le,e as E,f as ae,M as te,N as oe,h as se}from"./index-EyPvYnM7.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie=[{label:"男",value:1},{label:"女",value:2}],J=h=>Q.post(W+"/file/upload/img",h,{cancel:!1}),ne={class:"upload-box"},de=["src"],re={key:1,class:"upload-empty"},ue={class:"el-upload__tip"},pe=S({name:"UploadImg"}),me=S({...pe,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(h,{emit:I}){F(i=>({"21cec5b4":i.width,"4ba7e472":i.height,"7492ff04":i.borderRadius}));const u=h,m=$("id-"+X()),t=$(!1),v=D(N,void 0),c=D(j,void 0),V=Z(()=>u.disabled||(v==null?void 0:v.disabled)),b=I,a=async i=>{let d=new FormData;d.append("file",i.file);try{const e=u.api??J,{data:o}=await e(d);b("update:imageUrl",o.fileUrl),c!=null&&c.prop&&(v==null||v.validateField([c.prop]))}catch(e){i.onError(e)}},T=()=>{b("update:imageUrl","")},C=()=>{const i=document.querySelector(`#${m.value} .el-upload__input`);i&&i.dispatchEvent(new MouseEvent("click"))},_=i=>{const d=i.size/1024/1024<u.fileSize,e=u.fileType.includes(i.type);return e||y({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),d||setTimeout(()=>{y({title:"温馨提示",message:`上传图片大小不能超过 ${u.fileSize}M！`,type:"warning"})},0),e&&d},q=()=>{y({title:"温馨提示",message:"图片上传成功！",type:"success"})},w=()=>{y({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(i,d)=>{const e=r("Edit"),o=r("el-icon"),f=r("ZoomIn"),n=r("Delete"),B=r("Plus"),M=r("el-upload"),R=r("el-image-viewer");return g(),k("div",ne,[l(M,{id:m.value,action:"#",class:A(["upload",V.value?"disabled":"",i.drag?"no-border":""]),multiple:!1,disabled:V.value,"show-file-list":!1,"http-request":a,"before-upload":_,"on-success":q,"on-error":w,drag:i.drag,accept:i.fileType.join(",")},{default:s(()=>[i.imageUrl?(g(),k(H,{key:0},[p("img",{src:i.imageUrl,class:"upload-image"},null,8,de),p("div",{class:"upload-handle",onClick:d[1]||(d[1]=K(()=>{},["stop"]))},[V.value?z("",!0):(g(),k("div",{key:0,class:"handle-icon",onClick:C},[l(o,null,{default:s(()=>[l(e)]),_:1}),d[3]||(d[3]=p("span",null,"编辑",-1))])),p("div",{class:"handle-icon",onClick:d[0]||(d[0]=U=>t.value=!0)},[l(o,null,{default:s(()=>[l(f)]),_:1}),d[4]||(d[4]=p("span",null,"查看",-1))]),V.value?z("",!0):(g(),k("div",{key:1,class:"handle-icon",onClick:T},[l(o,null,{default:s(()=>[l(n)]),_:1}),d[5]||(d[5]=p("span",null,"删除",-1))]))])],64)):(g(),k("div",re,[P(i.$slots,"empty",{},()=>[l(o,null,{default:s(()=>[l(B)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),p("div",ue,[P(i.$slots,"tip",{},void 0,!0)]),t.value?(g(),L(R,{key:0,"url-list":[i.imageUrl],onClose:d[2]||(d[2]=U=>t.value=!1)},null,8,["url-list"])):z("",!0)])}}}),ce=x(me,[["__scopeId","data-v-6d73ecbd"]]),fe={class:"upload-box"},ve={class:"upload-empty"},ge=["src"],_e=["onClick"],be=["onClick"],we={class:"el-upload__tip"},ye=S({name:"UploadImgs"}),Ve=S({...ye,props:{fileList:{default:()=>[]},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:fileList"],setup(h,{emit:I}){F(e=>({"8b546a3e":e.borderRadius,"62eeec23":e.width,"3dc0c32c":e.height}));const u=h,m=D(N,void 0),t=D(j,void 0),v=Z(()=>u.disabled||(m==null?void 0:m.disabled)),c=$(u.fileList);Y(()=>u.fileList,e=>{c.value=e});const V=e=>{const o=e.size/1024/1024<u.fileSize,f=u.fileType.includes(e.type);return f||y({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),o||setTimeout(()=>{y({title:"温馨提示",message:`上传图片大小不能超过 ${u.fileSize}M！`,type:"warning"})},0),f&&o},b=async e=>{let o=new FormData;o.append("file",e.file);try{const f=u.api??J,{data:n}=await f(o);e.onSuccess(n)}catch(f){e.onError(f)}},a=I,T=(e,o)=>{e&&(o.url=e.fileUrl,a("update:fileList",c.value),t!=null&&t.prop&&(m==null||m.validateField([t.prop])),y({title:"温馨提示",message:"图片上传成功！",type:"success"}))},C=e=>{c.value=c.value.filter(o=>o.url!==e.url||o.name!==e.name),a("update:fileList",c.value)},_=()=>{y({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},q=()=>{y({title:"温馨提示",message:`当前最多只能上传 ${u.limit} 张图片，请移除后上传！`,type:"warning"})},w=$(""),i=$(!1),d=e=>{w.value=e.url,i.value=!0};return(e,o)=>{const f=r("el-icon"),n=r("ZoomIn"),B=r("Delete"),M=r("el-upload"),R=r("el-image-viewer");return g(),k("div",fe,[l(M,{"file-list":c.value,"onUpdate:fileList":o[1]||(o[1]=U=>c.value=U),action:"#","list-type":"picture-card",class:A(["upload",v.value?"disabled":"",e.drag?"no-border":""]),multiple:!0,disabled:v.value,limit:e.limit,"http-request":b,"before-upload":V,"on-exceed":q,"on-success":T,"on-error":_,drag:e.drag,accept:e.fileType.join(",")},{file:s(({file:U})=>[p("img",{src:U.url,class:"upload-image"},null,8,ge),p("div",{class:"upload-handle",onClick:o[0]||(o[0]=K(()=>{},["stop"]))},[p("div",{class:"handle-icon",onClick:G=>d(U)},[l(f,null,{default:s(()=>[l(n)]),_:1}),o[3]||(o[3]=p("span",null,"查看",-1))],8,_e),v.value?z("",!0):(g(),k("div",{key:0,class:"handle-icon",onClick:G=>C(U)},[l(f,null,{default:s(()=>[l(B)]),_:1}),o[4]||(o[4]=p("span",null,"删除",-1))],8,be))])]),default:s(()=>[p("div",ve,[P(e.$slots,"empty",{},()=>[l(f,null,{default:s(()=>[l(O(ee))]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),p("div",we,[P(e.$slots,"tip",{},void 0,!0)]),i.value?(g(),L(R,{key:0,"url-list":[w.value],onClose:o[2]||(o[2]=U=>i.value=!1)},null,8,["url-list"])):z("",!0)])}}}),Ue=x(Ve,[["__scopeId","data-v-5c930775"]]),ke=S({name:"UserDrawer"}),Ce=S({...ke,setup(h,{expose:I}){const u=le({avatar:[{required:!0,message:"请上传用户头像"}],photo:[{required:!0,message:"请上传用户照片"}],username:[{required:!0,message:"请填写用户姓名"}],gender:[{required:!0,message:"请选择性别"}],idCard:[{required:!0,message:"请填写身份证号"}],email:[{required:!0,message:"请填写邮箱"}],address:[{required:!0,message:"请填写居住地址"}]}),m=$(!1),t=$({isView:!1,title:"",row:{}}),v=b=>{t.value=b,m.value=!0},c=$(),V=()=>{c.value.validate(async b=>{if(b)try{await t.value.api(t.value.row),se.success({message:`${t.value.title}用户成功！`}),t.value.getTableList(),m.value=!1}catch{}})};return I({acceptParams:v}),(b,a)=>{const T=r("Avatar"),C=r("el-icon"),_=r("el-form-item"),q=r("Picture"),w=r("el-input"),i=r("el-option"),d=r("el-select"),e=r("el-form"),o=r("el-button"),f=r("el-drawer");return g(),L(f,{modelValue:m.value,"onUpdate:modelValue":a[8]||(a[8]=n=>m.value=n),"destroy-on-close":!0,size:"450px",title:`${t.value.title}用户`},{footer:s(()=>[l(o,{onClick:a[7]||(a[7]=n=>m.value=!1)},{default:s(()=>a[13]||(a[13]=[E("取消")])),_:1}),te(l(o,{type:"primary",onClick:V},{default:s(()=>a[14]||(a[14]=[E("确定")])),_:1},512),[[oe,!t.value.isView]])]),default:s(()=>[l(e,{ref_key:"ruleFormRef",ref:c,"label-width":"100px","label-suffix":" :",rules:u,disabled:t.value.isView,model:t.value.row,"hide-required-asterisk":t.value.isView},{default:s(()=>[l(_,{label:"用户头像",prop:"avatar"},{default:s(()=>[l(ce,{"image-url":t.value.row.avatar,"onUpdate:imageUrl":a[0]||(a[0]=n=>t.value.row.avatar=n),width:"135px",height:"135px","file-size":3},{empty:s(()=>[l(C,null,{default:s(()=>[l(T)]),_:1}),a[9]||(a[9]=p("span",null,"请上传头像",-1))]),tip:s(()=>a[10]||(a[10]=[E(" 头像大小不能超过 3M ")])),_:1},8,["image-url"])]),_:1}),l(_,{label:"用户照片",prop:"photo"},{default:s(()=>[l(Ue,{"file-list":t.value.row.photo,"onUpdate:fileList":a[1]||(a[1]=n=>t.value.row.photo=n),height:"140px",width:"140px","border-radius":"50%"},{empty:s(()=>[l(C,null,{default:s(()=>[l(q)]),_:1}),a[11]||(a[11]=p("span",null,"请上传照片",-1))]),tip:s(()=>a[12]||(a[12]=[E(" 照片大小不能超过 5M ")])),_:1},8,["file-list"])]),_:1}),l(_,{label:"用户姓名",prop:"username"},{default:s(()=>[l(w,{modelValue:t.value.row.username,"onUpdate:modelValue":a[2]||(a[2]=n=>t.value.row.username=n),placeholder:"请填写用户姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(_,{label:"性别",prop:"gender"},{default:s(()=>[l(d,{modelValue:t.value.row.gender,"onUpdate:modelValue":a[3]||(a[3]=n=>t.value.row.gender=n),placeholder:"请选择性别",clearable:""},{default:s(()=>[(g(!0),k(H,null,ae(O(ie),n=>(g(),L(i,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,{label:"身份证号",prop:"idCard"},{default:s(()=>[l(w,{modelValue:t.value.row.idCard,"onUpdate:modelValue":a[4]||(a[4]=n=>t.value.row.idCard=n),placeholder:"请填写身份证号",clearable:""},null,8,["modelValue"])]),_:1}),l(_,{label:"邮箱",prop:"email"},{default:s(()=>[l(w,{modelValue:t.value.row.email,"onUpdate:modelValue":a[5]||(a[5]=n=>t.value.row.email=n),placeholder:"请填写邮箱",clearable:""},null,8,["modelValue"])]),_:1}),l(_,{label:"居住地址",prop:"address"},{default:s(()=>[l(w,{modelValue:t.value.row.address,"onUpdate:modelValue":a[6]||(a[6]=n=>t.value.row.address=n),placeholder:"请填写居住地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","disabled","model","hide-required-asterisk"])]),_:1},8,["modelValue","title"])}}});export{Ce as _};
