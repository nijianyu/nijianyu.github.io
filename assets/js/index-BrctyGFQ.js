import{E as Te,h as J,i as ee,j as He,k as Xe,l as I,m as ue,n as Ge,p as A,d as E,q as te,g as N,o as C,s as $e,w as c,a as L,t as Q,c as H,v as F,F as W,f as ie,x as ce,y as K,u as k,z as q,A as Ke,B as Pe,C as We,D as Ze,G as Ye,H as ae,I as Ae,J as de,K as xe,L as qe,M as le,N as Ne,r as S,O,b as f,P as Qe,Q as Ue,e as D,R as be,S as Je,T as et,U as tt,V as at,W as lt,X as we,Y as nt,Z as ge,_ as ot,$ as rt,a0 as st,a1 as ut,a2 as Ve,a3 as it,a4 as Be,a5 as X,a6 as G,a7 as ct,a8 as dt,a9 as pt,aa as ft,ab as mt,ac as vt}from"./index-EyPvYnM7.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as gt}from"./sortable.esm-C83syoBY.js";import{_ as bt}from"./UserDrawer.vue_vue_type_script_setup_true_name_UserDrawer_lang-FXxJ8psR.js";const se=(b,d={},r,a="warning")=>new Promise((p,t)=>{Te.confirm(`是否${r}?`,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:a,draggable:!0}).then(async()=>{if(!await b(d))return t(!1);J({type:"success",message:`${r}成功!`}),p(!0)}).catch(()=>{})}),ze=async(b,d,r={},a=!0,p=".xlsx")=>{a&&ee({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const t=await b(r),n=new Blob([t]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(n,d+p);const l=window.URL.createObjectURL(n),m=document.createElement("a");m.style.display="none",m.download=`${d}${p}`,m.href=l,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(l)}catch{}},ht=()=>{const b=He(),r=Xe().authButtonListGet[b.name]||[];return{BUTTONS:I(()=>{let p={};return r.forEach(t=>p[t]=!0),p})}},Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAzCAMAAAA3r39rAAABEVBMVEUAAADb29va2trY2Njj4+PX19fZ2dng4ODf39/X19fj4+Py8vLk5OTt7e3V1dX09PT29vbZ2dn39/fY2Nj29vbb29v29vb29vb19fX29vbV1dX39/f29vb29vb19fXc3NzZ2dnd3d3e3t7h4eH19fX19fXZ2dn19fX39/fb29vb29vW1tb19fXT09P29vbf39/29vb19fXU1NTn5+fc3NzR0dH29vb19fX19fX29vbT09P39/f19fX39/ff39/39/fX19f19fXr6+vo6OjZ2dnn5+fb29vj4+Pd3d319fXm5ubm5ubj4+PY2Nja2tr39/fk5OT6+vr09PTm5ub39/f8/Pzx8fHi4uLp6enr6+vt7e37h5dsAAAAUXRSTlMAQpJ0ChanzshV+g7jBMAS47ONcNMd++jew4heMx7LwJ5HI/j387y3rKx3XFNPSeSabWswKyjt2b2ikYWBc108mZZsaT339evZsKycgX5QGL+U+rOeAAAC3UlEQVRYw+WV13qiQBiGiaIbJaAgFgTsvZds7DG9l3UEBnP/F7IIDyYmgDB7uO8R4Mc7/8z8I5gdhabfgfMC5pHfvnrOZ0uu7vvt0TfN9vNHtuSvqLQnYzxNneNOAfy8ko679xEv2QHpHCGvqRfCrQ8fZF/xg6FGZYC79DUpN9MJvFJNd8a3is9VUxR8lZCb3BGdc7mBhRydP5waBulTzCWn9frw4KhB+ghzzQ0dLBxowAs6hHngjc7FERraHtK5IyKx7BWBeYK4zjYitg14TW9/9Gj001e4XfkVXwDzTGBKN0nL+kIU5W+3Qyb5uMNa53exdjtGUSHcaqSLu+7xr0+Og7Zdmw/uBbt3FwErYbD4AZQdQIH1U7t+hspXPopBa2EYyKsdsqx0G9bCxokif02CsLPQzEnw2Vr4vNYD7oUm8Im07IYndbWHa6FasVzEYXYjowmV7rR9c/SNm/a0CxAqNIzFh+MfPBSVFYLQVP5EKw9ZaDaH81NnIQK2wlwRrNCExZyVkEjfowrv04SFEI+doApPYriNUP7PhAN04cBKGPGjCy2+bYTQz4ZRdzn8py8Qe7bOrMaNbteowvXtiKvNOqZT5BmuDCSwRheq2utljuHF7V4se1Gg8Q9CRRdqRHtLHGtx2pUhhIqMJoSa0JBwLWycMHQS+EAUyhuo6AKNxBjT52s4obqSNfSUcfU5gH4jf8N4Iq0hkCRgEMUuk6ZQ2kBVAZ5RVLjRfEaNyUtsyET1SW9vVQjXnoFwY7oTUWaonRC+miztRvMuVLcLuKWUrPL6icHFDsMm9EkDFCT9vQTLdETzSJPikp/X2JKESImtzfmlSO7/NwitBTOpZlJl4IFyKlOdMIuWEMGsIN+FVn/Wq1W5DJuKJs/KpcRnU5kkSuWzZDTFZrhqrTfrt4R3EnOAxAkiIgodfjFnepPHcSbDjlJb+VaSGrFsZvw4uWTmC74jiBGCwL/b/gIpvWL/TS00iAAAAABJRU5ErkJggg==",yt=(b,d={},r=!0,a,p)=>{const t=ue({tableData:[],pageable:{pageNum:1,pageSize:10,total:0},searchParam:{},searchInitParam:{},totalParam:{}}),n=I({get:()=>({pageNum:t.pageable.pageNum,pageSize:t.pageable.pageSize}),set:u=>{}}),l=async()=>{if(b)try{Object.assign(t.totalParam,d,r?n.value:{});let{data:u}=await b({...t.searchInitParam,...t.totalParam});a&&(u=a(u)),t.tableData=r?u.list:u,r&&(t.pageable.total=u.total)}catch(u){p&&p(u)}},m=()=>{t.totalParam={};let u={};for(let h in t.searchParam)(t.searchParam[h]||t.searchParam[h]===!1||t.searchParam[h]===0)&&(u[h]=t.searchParam[h]);Object.assign(t.totalParam,u)},e=()=>{t.pageable.pageNum=1,m(),l()},s=()=>{t.pageable.pageNum=1,t.searchParam={...t.searchInitParam},m(),l()},v=u=>{t.pageable.pageNum=1,t.pageable.pageSize=u,l()},g=u=>{t.pageable.pageNum=u,l()};return{...Ge(t),getTableList:l,search:e,reset:s,handleSizeChange:v,handleCurrentChange:g,updatedTotalParam:m}},_t=(b="id")=>{const d=A(!1),r=A([]),a=I(()=>{let t=[];return r.value.forEach(n=>t.push(n[b])),t});return{isSelected:d,selectedList:r,selectedListIds:a,selectionChange:t=>{t.length?d.value=!0:d.value=!1,r.value=t}}},wt=E({name:"SearchFormItem"}),Ct=E({...wt,props:{column:{},searchParam:{}},setup(b){const d=b,r=I(()=>d.searchParam),a=I(()=>{var e,s,v;return{label:((e=d.column.fieldNames)==null?void 0:e.label)??"label",value:((s=d.column.fieldNames)==null?void 0:s.value)??"value",children:((v=d.column.fieldNames)==null?void 0:v.children)??"children"}}),p=te("enumMap",A(new Map)),t=I(()=>{var s;let e=p.value.get(d.column.prop);return e?(((s=d.column.search)==null?void 0:s.el)==="select-v2"&&d.column.fieldNames&&(e=e.map(v=>({...v,label:v[a.value.label],value:v[a.value.value]}))),e):[]}),n=I(()=>{var h,_;const e=a.value.label,s=a.value.value,v=a.value.children,g=(h=d.column.search)==null?void 0:h.el;let u=((_=d.column.search)==null?void 0:_.props)??{};return g==="tree-select"&&(u={...u,props:{...u,label:e,children:v},nodeKey:s}),g==="cascader"&&(u={...u,props:{...u,label:e,value:s,children:v}}),u}),l=I(()=>{var v,g,u,h,_,V,U;const e=d.column.search;return["datetimerange","daterange","monthrange"].includes((v=e==null?void 0:e.props)==null?void 0:v.type)||(g=e==null?void 0:e.props)!=null&&g.isRange?{rangeSeparator:((u=e==null?void 0:e.props)==null?void 0:u.rangeSeparator)??"至",startPlaceholder:((h=e==null?void 0:e.props)==null?void 0:h.startPlaceholder)??"开始时间",endPlaceholder:((_=e==null?void 0:e.props)==null?void 0:_.endPlaceholder)??"结束时间"}:{placeholder:((V=e==null?void 0:e.props)==null?void 0:V.placeholder)??((U=e==null?void 0:e.el)!=null&&U.includes("input")?"请输入":"请选择")}}),m=I(()=>{var s;const e=d.column.search;return((s=e==null?void 0:e.props)==null?void 0:s.clearable)??((e==null?void 0:e.defaultValue)==null||(e==null?void 0:e.defaultValue)==null)});return(e,s)=>{var v,g,u,h,_,V;return C(),N(ce(((v=e.column.search)==null?void 0:v.render)??`el-${(g=e.column.search)==null?void 0:g.el}`),K({...n.value,...l.value,searchParam:r.value,clearable:m.value},{modelValue:r.value[((u=e.column.search)==null?void 0:u.key)??k(q)(e.column.prop)],"onUpdate:modelValue":s[0]||(s[0]=U=>{var $;return r.value[(($=e.column.search)==null?void 0:$.key)??k(q)(e.column.prop)]=U}),modelModifiers:{trim:!0},data:((h=e.column.search)==null?void 0:h.el)==="tree-select"?t.value:[],options:["cascader","select-v2"].includes((_=e.column.search)==null?void 0:_.el)?t.value:[]}),$e({default:c(()=>{var U;return[((U=e.column.search)==null?void 0:U.el)==="select"?(C(!0),H(W,{key:0},ie(t.value,($,B)=>(C(),N(ce("el-option"),{key:B,label:$[a.value.label],value:$[a.value.value]},null,8,["label","value"]))),128)):F(e.$slots,"default",{key:1})]}),_:2},[((V=e.column.search)==null?void 0:V.el)==="cascader"?{name:"default",fn:c(({data:U})=>[L("span",null,Q(U[a.value.label]),1)]),key:"0"}:void 0]),1040,["modelValue","data","options"])}}}),St=E({name:"Grid"}),kt=E({...St,props:{cols:{default:()=>({xs:1,sm:2,md:2,lg:3,xl:4})},collapsed:{type:Boolean,default:!1},collapsedRows:{default:1},gap:{default:0}},setup(b,{expose:d}){const r=b;Ke(()=>r.collapsed&&m()),Pe(()=>{a({target:{innerWidth:window.innerWidth}}),window.addEventListener("resize",a)}),We(()=>{a({target:{innerWidth:window.innerWidth}}),window.addEventListener("resize",a)}),Ze(()=>{window.removeEventListener("resize",a)}),Ye(()=>{window.removeEventListener("resize",a)});const a=v=>{let g=v.target.innerWidth;switch(!!g){case g<768:p.value="xs";break;case(g>=768&&g<992):p.value="sm";break;case(g>=992&&g<1200):p.value="md";break;case(g>=1200&&g<1920):p.value="lg";break;case g>=1920:p.value="xl";break}};ae("gap",Array.isArray(r.gap)?r.gap[0]:r.gap);let p=A("xl");ae("breakPoint",p);const t=A(-1);ae("shouldHiddenIndex",t);const n=I(()=>typeof r.cols=="object"?r.cols[p.value]??r.cols:r.cols);ae("cols",n);const l=Ae().default(),m=()=>{var h,_,V,U;let v=[],g=null;l.forEach($=>{var B;typeof $.type=="object"&&$.type.name==="GridItem"&&((B=$.props)==null?void 0:B.suffix)!==void 0&&(g=$),typeof $.type=="symbol"&&Array.isArray($.children)&&v.push(...$.children)});let u=0;g&&(u=(((h=g.props[p.value])==null?void 0:h.span)??((_=g.props)==null?void 0:_.span)??1)+(((V=g.props[p.value])==null?void 0:V.offset)??((U=g.props)==null?void 0:U.offset)??0));try{let $=!1;v.reduce((B=0,i,o)=>{var P,M,x,j;if(B+=(((P=i.props[p.value])==null?void 0:P.span)??((M=i.props)==null?void 0:M.span)??1)+(((x=i.props[p.value])==null?void 0:x.offset)??((j=i.props)==null?void 0:j.offset)??0),Number(B)>r.collapsedRows*n.value-u)throw t.value=o,$=!0,"find it";return B},0),$||(t.value=-1)}catch{}};de(()=>p.value,()=>{r.collapsed&&m()}),de(()=>r.collapsed,v=>{if(v)return m();t.value=-1});const e=I(()=>typeof r.gap=="number"?`${r.gap}px`:Array.isArray(r.gap)?`${r.gap[1]}px ${r.gap[0]}px`:"unset"),s=I(()=>({display:"grid",gridGap:e.value,gridTemplateColumns:`repeat(${n.value}, minmax(0, 1fr))`}));return d({breakPoint:p}),(v,g)=>(C(),H("div",{style:xe(s.value)},[F(v.$slots,"default")],4))}}),Tt=E({name:"GridItem"}),Ce=E({...Tt,props:{offset:{default:0},span:{default:1},suffix:{type:Boolean,default:!1},xs:{default:void 0},sm:{default:void 0},md:{default:void 0},lg:{default:void 0},xl:{default:void 0}},setup(b){const d=b,r=qe(),a=A(!0),p=te("breakPoint",A("xl")),t=te("shouldHiddenIndex",A(-1));de(()=>[t.value,p.value],e=>{r.index&&(a.value=!(e[0]!==-1&&parseInt(r.index)>=Number(e[0])))},{immediate:!0});const n=te("gap",0),l=te("cols",A(4)),m=I(()=>{var v,g;let e=((v=d[p.value])==null?void 0:v.span)??d.span,s=((g=d[p.value])==null?void 0:g.offset)??d.offset;return d.suffix?{gridColumnStart:l.value-e-s+1,gridColumnEnd:`span ${e+s}`,marginLeft:s!==0?`calc(((100% + ${n}px) / ${e+s}) * ${s})`:"unset"}:{gridColumn:`span ${e+s>l.value?l.value:e+s}/span ${e+s>l.value?l.value:e+s}`,marginLeft:s!==0?`calc(((100% + ${n}px) / ${e+s}) * ${s})`:"unset"}});return(e,s)=>le((C(),H("div",{style:xe(m.value)},[F(e.$slots,"default")],4)),[[Ne,a.value]])}}),$t={key:0,class:"card table-search"},Pt={class:"operation"},At=E({name:"SearchForm"}),xt=E({...At,props:{columns:{default:()=>[]},searchParam:{default:()=>({})},searchCol:{},search:{},reset:{}},setup(b){const d=b,r=l=>{var m,e,s,v,g,u,h;return{span:(m=l.search)==null?void 0:m.span,offset:((e=l.search)==null?void 0:e.offset)??0,xs:(s=l.search)==null?void 0:s.xs,sm:(v=l.search)==null?void 0:v.sm,md:(g=l.search)==null?void 0:g.md,lg:(u=l.search)==null?void 0:u.lg,xl:(h=l.search)==null?void 0:h.xl}},a=A(!0),p=A(),t=I(()=>{var l;return(l=p.value)==null?void 0:l.breakPoint}),n=I(()=>{let l=!1;return d.columns.reduce((m,e)=>{var s,v,g,u;return m+=(((s=e.search[t.value])==null?void 0:s.span)??((v=e.search)==null?void 0:v.span)??1)+(((g=e.search[t.value])==null?void 0:g.offset)??((u=e.search)==null?void 0:u.offset)??0),typeof d.searchCol!="number"?m>=d.searchCol[t.value]&&(l=!0):m>=d.searchCol&&(l=!0),m},0),l});return(l,m)=>{const e=S("el-tooltip"),s=S("el-space"),v=S("el-form-item"),g=S("el-button"),u=S("el-icon"),h=S("el-form");return l.columns.length?(C(),H("div",$t,[f(h,{ref:"formRef",model:l.searchParam},{default:c(()=>[f(kt,{ref_key:"gridRef",ref:p,collapsed:a.value,gap:[20,0],cols:l.searchCol},{default:c(()=>[(C(!0),H(W,null,ie(l.columns,(_,V)=>(C(),N(Ce,K({key:_.prop,ref_for:!0},r(_),{index:V}),{default:c(()=>[f(v,null,{label:c(()=>[f(s,{size:4},{default:c(()=>{var U,$,B;return[L("span",null,Q(`${((U=_.search)==null?void 0:U.label)??_.label}`),1),($=_.search)!=null&&$.tooltip?(C(),N(e,{key:0,effect:"dark",content:(B=_.search)==null?void 0:B.tooltip,placement:"top"},{default:c(()=>m[1]||(m[1]=[L("i",{class:Qe("iconfont icon-yiwen")},null,-1)])),_:2},1032,["content"])):O("",!0)]}),_:2},1024),m[2]||(m[2]=L("span",null," :",-1))]),default:c(()=>[f(Ct,{column:_,"search-param":l.searchParam},null,8,["column","search-param"])]),_:2},1024)]),_:2},1040,["index"]))),128)),f(Ce,{suffix:""},{default:c(()=>[L("div",Pt,[f(g,{type:"primary",icon:k(Ue),onClick:l.search},{default:c(()=>m[3]||(m[3]=[D(" 搜索 ")])),_:1},8,["icon","onClick"]),f(g,{icon:k(be),onClick:l.reset},{default:c(()=>m[4]||(m[4]=[D(" 重置 ")])),_:1},8,["icon","onClick"]),n.value?(C(),N(g,{key:0,type:"primary",link:"",class:"search-isOpen",onClick:m[0]||(m[0]=_=>a.value=!a.value)},{default:c(()=>[D(Q(a.value?"展开":"合并")+" ",1),f(u,{class:"el-icon--right"},{default:c(()=>[(C(),N(ce(a.value?k(Je):k(et))))]),_:1})]),_:1})):O("",!0)])]),_:1})]),_:1},8,["collapsed","cols"])]),_:1},8,["model"])])):O("",!0)}}}),Nt=E({name:"Pagination"}),Ut=E({...Nt,props:{pageable:{},handleSizeChange:{type:Function},handleCurrentChange:{type:Function}},setup(b){const d=tt();return(r,a)=>{var t;const p=S("el-pagination");return C(),N(p,{background:!0,"current-page":r.pageable.pageNum,"page-size":r.pageable.pageSize,"page-sizes":[10,25,50,100],total:r.pageable.total,size:((t=k(d))==null?void 0:t.assemblySize)??"default",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["current-page","page-size","total","size","onSizeChange","onCurrentChange"])}}}),Vt={class:"table-main"},Bt=E({name:"ColSetting"}),Et=E({...Bt,props:{colSetting:{}},setup(b,{expose:d}){const r=A(!1);return d({openColSetting:()=>{r.value=!0}}),(p,t)=>{const n=S("el-table-column"),l=S("el-switch"),m=S("el-table"),e=S("el-drawer");return C(),N(e,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),title:"列设置",size:"450px"},{default:c(()=>[L("div",Vt,[f(m,{data:p.colSetting,border:!0,"row-key":"prop","default-expand-all":"","tree-props":{children:"_children"}},{empty:c(()=>t[1]||(t[1]=[L("div",{class:"table-empty"},[L("img",{src:Le,alt:"notData"}),L("div",null,"暂无可配置列")],-1)])),default:c(()=>[f(n,{prop:"label",align:"center",label:"列名"}),f(n,{prop:"isShow",align:"center",label:"显示"},{default:c(s=>[f(l,{modelValue:s.row.isShow,"onUpdate:modelValue":v=>s.row.isShow=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),f(n,{prop:"sortable",align:"center",label:"排序"},{default:c(s=>[f(l,{modelValue:s.row.sortable,"onUpdate:modelValue":v=>s.row.sortable=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"])}}}),zt=Ee(Et,[["__scopeId","data-v-0cba8348"]]);function Lt(b){return typeof b=="function"||Object.prototype.toString.call(b)==="[object Object]"&&!ot(b)}const Rt=E({name:"TableColumn"}),Dt=E({...Rt,props:{column:{}},setup(b){const d=Ae(),r=te("enumMap",A(new Map)),a=(n,l)=>r.value.get(n.prop)&&n.isFilterEnum?we(ge(l.row,n.prop),r.value.get(n.prop),n.fieldNames):nt(ge(l.row,n.prop)),p=(n,l)=>we(ge(l.row,n.prop),r.value.get(n.prop),n.fieldNames,"tag")||"primary",t=n=>f(W,null,[n.isShow&&f(S("el-table-column"),K(n,{align:n.align??"center",showOverflowTooltip:n.showOverflowTooltip??n.prop!=="operation"}),{default:l=>{let m;return n._children?n._children.map(e=>t(e)):n.render?n.render(l):n.prop&&d[q(n.prop)]?d[q(n.prop)](l):n.tag?f(S("el-tag"),{type:p(n,l)},Lt(m=a(n,l))?m:{default:()=>[m]}):a(n,l)},header:l=>n.headerRender?n.headerRender(l):n.prop&&d[`${q(n.prop)}Header`]?d[`${q(n.prop)}Header`](l):n.label})]);return(n,l)=>(C(),N(t,at(lt(n.column)),null,16))}}),It={class:"card table-main"},Mt={class:"table-header"},jt={class:"header-button-lf"},Ft={key:0,class:"header-button-ri"},Ot={class:"table-empty"},Ht=E({name:"ProTable"}),Xt=E({...Ht,props:{columns:{default:()=>[]},data:{},requestApi:{},requestAuto:{type:Boolean,default:!0},requestError:{},dataCallback:{},title:{},pagination:{type:Boolean,default:!0},initParam:{default:{}},border:{type:Boolean,default:!0},toolButton:{type:[Array,Boolean],default:!0},rowKey:{default:"id"},searchCol:{default:()=>({xs:1,sm:2,md:2,lg:3,xl:4})}},emits:["search","reset","dragSort"],setup(b,{expose:d,emit:r}){var _e;const a=b,p=A(),t=A("id-"+rt()),n=["selection","radio","index","expand","sort"],l=A(!0),m=y=>Array.isArray(a.toolButton)?a.toolButton.includes(y):a.toolButton,e=A(""),{selectionChange:s,selectedList:v,selectedListIds:g,isSelected:u}=_t(a.rowKey),{tableData:h,pageable:_,searchParam:V,searchInitParam:U,getTableList:$,search:B,reset:i,handleSizeChange:o,handleCurrentChange:P}=yt(a.requestApi,a.initParam,a.pagination,a.dataCallback,a.requestError),M=()=>p.value.clearSelection();Pe(()=>{Fe(),a.requestAuto&&$(),a.data&&(_.value.total=a.data.length)});const x=I(()=>a.data?a.pagination?a.data.slice((_.value.pageNum-1)*_.value.pageSize,_.value.pageSize*_.value.pageNum):a.data:h.value);de(()=>a.initParam,$,{deep:!0});const j=ue(a.columns),Re=I(()=>he(j)),Z=A(new Map),De=async({prop:y,enum:w})=>{if(!w||Z.value.has(y)&&(typeof w=="function"||Z.value.get(y)===w))return;if(typeof w!="function")return Z.value.set(y,k(w));Z.value.set(y,[]);const{data:T}=await w();Z.value.set(y,T)};ae("enumMap",Z);const he=(y,w=[])=>(y.forEach(async T=>{var z;(z=T._children)!=null&&z.length&&w.push(...he(T._children)),w.push(T),T.isShow=T.isShow??!0,T.isSetting=T.isSetting??!0,T.isFilterEnum=T.isFilterEnum??!0,await De(T)}),w.filter(T=>{var z;return!((z=T._children)!=null&&z.length)})),pe=I(()=>{var y;return(y=Re.value)==null?void 0:y.filter(w=>{var T,z;return((T=w.search)==null?void 0:T.el)||((z=w.search)==null?void 0:z.render)}).sort((w,T)=>w.search.order-T.search.order)});(_e=pe.value)==null||_e.forEach((y,w)=>{var ne,oe,re;y.search.order=((ne=y.search)==null?void 0:ne.order)??w+2;const T=((oe=y.search)==null?void 0:oe.key)??q(y.prop),z=(re=y.search)==null?void 0:re.defaultValue;z!=null&&(V.value[T]=z,U.value[T]=z)});const ye=A(),fe=j.filter(y=>{const{type:w,prop:T,isSetting:z}=y;return!n.includes(w)&&T!=="operation"&&z}),Ie=()=>ye.value.openColSetting(),me=r,Me=()=>{B(),me("search")},je=()=>{i(),me("reset")},Fe=()=>{const y=document.querySelector(`#${t.value} tbody`);gt.create(y,{handle:".move",animation:300,onEnd({newIndex:w,oldIndex:T}){const[z]=x.value.splice(T,1);x.value.splice(w,0,z),me("dragSort",{newIndex:w,oldIndex:T})}})};return d({element:p,tableData:x,radio:e,pageable:_,searchParam:V,searchInitParam:U,isSelected:u,selectedList:v,selectedListIds:g,getTableList:$,search:B,reset:i,handleSizeChange:o,handleCurrentChange:P,clearSelection:M,enumMap:Z}),(y,w)=>{const T=S("el-button"),z=S("el-radio"),ne=S("DCaret"),oe=S("el-icon"),re=S("el-tag"),Oe=S("el-table-column");return C(),H(W,null,[le(f(xt,{search:Me,reset:je,columns:pe.value,"search-param":k(V),"search-col":y.searchCol},null,8,["columns","search-param","search-col"]),[[Ne,l.value]]),L("div",It,[L("div",Mt,[L("div",jt,[F(y.$slots,"tableHeader",{selectedList:k(v),selectedListIds:k(g),isSelected:k(u)})]),y.toolButton?(C(),H("div",Ft,[F(y.$slots,"toolButton",{},()=>{var R;return[m("refresh")?(C(),N(T,{key:0,icon:k(Ve),circle:"",onClick:k($)},null,8,["icon","onClick"])):O("",!0),m("setting")&&y.columns.length?(C(),N(T,{key:1,icon:k(it),circle:"",onClick:Ie},null,8,["icon"])):O("",!0),m("search")&&((R=pe.value)!=null&&R.length)?(C(),N(T,{key:2,icon:k(Ue),circle:"",onClick:w[0]||(w[0]=Y=>l.value=!l.value)},null,8,["icon"])):O("",!0)]})])):O("",!0)]),f(k(st),K({ref_key:"tableRef",ref:p},y.$attrs,{id:t.value,data:x.value,border:y.border,"row-key":y.rowKey,onSelectionChange:k(s)}),{append:c(()=>[F(y.$slots,"append")]),empty:c(()=>[L("div",Ot,[F(y.$slots,"empty",{},()=>[w[4]||(w[4]=L("img",{src:Le,alt:"notData"},null,-1)),w[5]||(w[5]=L("div",null,"暂无数据",-1))])])]),default:c(()=>[F(y.$slots,"default"),(C(!0),H(W,null,ie(j,R=>(C(),H(W,{key:R},[R.type&&n.includes(R.type)?(C(),N(Oe,K({key:0,ref_for:!0},R,{align:R.align??"center","reserve-selection":R.type=="selection"}),{default:c(Y=>[R.type=="expand"?(C(),H(W,{key:0},[R.render?(C(),N(ce(R.render),K({key:0,ref_for:!0},Y),null,16)):F(y.$slots,R.type,K({key:1,ref_for:!0},Y))],64)):O("",!0),R.type=="radio"?(C(),N(z,{key:1,modelValue:e.value,"onUpdate:modelValue":w[1]||(w[1]=ve=>e.value=ve),value:Y.row[y.rowKey]},{default:c(()=>w[3]||(w[3]=[L("i",null,null,-1)])),_:2},1032,["modelValue","value"])):O("",!0),R.type=="sort"?(C(),N(re,{key:2,class:"move"},{default:c(()=>[f(oe,null,{default:c(()=>[f(ne)]),_:1})]),_:1})):O("",!0)]),_:2},1040,["align","reserve-selection"])):(C(),N(Dt,{key:1,column:R},$e({_:2},[ie(Object.keys(y.$slots),Y=>({name:Y,fn:c(ve=>[F(y.$slots,Y,K({ref_for:!0},ve))])}))]),1032,["column"]))],64))),128))]),_:3},16,["id","data","border","row-key","onSelectionChange"]),F(y.$slots,"pagination",{},()=>[y.pagination?(C(),N(Ut,{key:0,pageable:k(_),"handle-size-change":k(o),"handle-current-change":k(P)},null,8,["pageable","handle-size-change","handle-current-change"])):O("",!0)])]),y.toolButton?(C(),N(zt,{key:0,ref_key:"colRef",ref:ye,"col-setting":k(fe),"onUpdate:colSetting":w[2]||(w[2]=R=>ut(fe)?fe.value=R:null)},null,8,["col-setting"])):O("",!0)],64)}}}),Gt={class:"el-upload__tip"},Kt=E({name:"ImportExcel"}),Wt=E({...Kt,setup(b,{expose:d}){const r=A(!1),a=A(1),p=A(!1),t=A({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),n=u=>{t.value={...t.value,...u},p.value=!0},l=()=>{t.value.tempApi&&ze(t.value.tempApi,`${t.value.title}模板`)},m=async u=>{let h=new FormData;h.append("file",u.file),h.append("isCover",r.value),await t.value.importApi(h),t.value.getTableList&&t.value.getTableList(),p.value=!1},e=u=>{const h=t.value.fileType.includes(u.type),_=u.size/1024/1024<t.value.fileSize;return h||ee({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),_||setTimeout(()=>{ee({title:"温馨提示",message:`上传文件大小不能超过 ${t.value.fileSize}MB！`,type:"warning"})},0),h&&_},s=()=>{ee({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},v=()=>{ee({title:"温馨提示",message:`批量添加${t.value.title}失败，请您重新上传！`,type:"error"})},g=()=>{ee({title:"温馨提示",message:`批量添加${t.value.title}成功！`,type:"success"})};return d({acceptParams:n}),(u,h)=>{const _=S("el-button"),V=S("el-form-item"),U=S("upload-filled"),$=S("el-icon"),B=S("el-upload"),i=S("el-switch"),o=S("el-form"),P=S("el-dialog");return C(),N(P,{modelValue:p.value,"onUpdate:modelValue":h[1]||(h[1]=M=>p.value=M),title:`批量添加${t.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:c(()=>[f(o,{class:"drawer-multiColumn-form","label-width":"100px"},{default:c(()=>[f(V,{label:"模板下载 :"},{default:c(()=>[f(_,{type:"primary",icon:k(Be),onClick:l},{default:c(()=>h[2]||(h[2]=[D(" 点击下载 ")])),_:1},8,["icon"])]),_:1}),f(V,{label:"文件上传 :"},{default:c(()=>[f(B,{action:"#",class:"upload",drag:!0,limit:a.value,multiple:!0,"show-file-list":!0,"http-request":m,"before-upload":e,"on-exceed":s,"on-success":g,"on-error":v,accept:t.value.fileType.join(",")},{tip:c(()=>[F(u.$slots,"tip",{},()=>[L("div",Gt,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+Q(t.value.fileSize)+"M",1)],!0)]),default:c(()=>[F(u.$slots,"empty",{},()=>[f($,{class:"el-icon--upload"},{default:c(()=>[f(U)]),_:1}),h[3]||(h[3]=L("div",{class:"el-upload__text"},[D("将文件拖到此处，或"),L("em",null,"点击上传")],-1))],!0)]),_:3},8,["limit","accept"])]),_:3}),f(V,{label:"数据覆盖 :"},{default:c(()=>[f(i,{modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=M=>r.value=M)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}}),Zt=Ee(Wt,[["__scopeId","data-v-6c0f1180"]]),Yt=b=>X.post(G+"/user/list",b),qt=b=>X.post(G+"/user/add",b),Qt=b=>X.post(G+"/user/import",b),Jt=b=>X.post(G+"/user/edit",b),Se=b=>X.post(G+"/user/delete",b),ea=b=>X.post(G+"/user/change",b),ta=b=>X.post(G+"/user/rest_password",b),ke=b=>X.download(G+"/user/export",b),aa=()=>X.get(G+"/user/status"),la=()=>X.get(G+"/user/gender"),na={class:"table-box"},oa=E({name:"ClueCustomer"}),ca=E({...oa,setup(b){const d=ct(),r=()=>{d.push(`/proTable/useProTable/detail/${Math.random().toFixed(3)}?params=detail-page`)},a=A(),p=ue({type:1}),t=i=>({list:i.list,total:i.total}),n=i=>{let o=JSON.parse(JSON.stringify(i));return o.createTime&&(o.startTime=o.createTime[0]),o.createTime&&(o.endTime=o.createTime[1]),delete o.createTime,Yt(o)},{BUTTONS:l}=ht(),e=ue([{type:"selection",fixed:"left",width:70},{type:"sort",label:"Sort",width:80},{type:"expand",label:"Expand",width:85},{prop:"username",label:"用户姓名",search:{el:"input",tooltip:"我是搜索提示"},render:i=>f(S("el-button"),{type:"primary",link:!0,onClick:()=>J.success("我是通过 tsx 语法渲染的内容")},{default:()=>[i.row.username]})},{prop:"gender",label:"性别",enum:la,search:{el:"select",props:{filterable:!0}},fieldNames:{label:"genderLabel",value:"genderValue"}},{prop:"user.detail.age",label:"年龄",search:{render:({searchParam:i})=>f("div",{class:"flx-center"},[f(S("el-input"),{modelValue:i.minAge,modelModifiers:{trim:!0},"onUpdate:modelValue":o=>i.minAge=o,placeholder:"最小年龄"},null),f("span",{class:"mr10 ml10"},[D("-")]),f(S("el-input"),{modelValue:i.maxAge,modelModifiers:{trim:!0},"onUpdate:modelValue":o=>i.maxAge=o,placeholder:"最大年龄"},null)])}},{prop:"idCard",label:"身份证号",search:{el:"input"}},{prop:"email",label:"邮箱"},{prop:"address",label:"居住地址"},{prop:"status",label:"用户状态",enum:aa,search:{el:"tree-select",props:{filterable:!0}},fieldNames:{label:"userLabel",value:"userStatus"},render:i=>f(W,null,[l.value.status?f(S("el-switch"),{"model-value":i.row.status,"active-text":i.row.status?"启用":"禁用","active-value":1,"inactive-value":0,onClick:()=>h(i.row)},null):f(S("el-tag"),{type:i.row.status?"success":"danger"},{default:()=>[i.row.status?"启用":"禁用"]})])},{prop:"createTime",label:"创建时间",headerRender:i=>f(S("el-button"),{type:"primary",onClick:()=>J.success("我是通过 tsx 语法渲染的表头")},{default:()=>[i.column.label]}),width:180,search:{el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"},defaultValue:["2022-11-12 11:35:00","2022-12-12 11:35:00"]}},{prop:"operation",label:"操作",fixed:"right",width:330}]),s=({newIndex:i,oldIndex:o})=>{var P;(P=a.value)==null||P.tableData,J.success("修改列表排序成功")},v=async i=>{var o;await se(Se,{id:[i.id]},`删除【${i.username}】用户`),(o=a.value)==null||o.getTableList()},g=async i=>{var o,P;await se(Se,{id:i},"删除所选用户信息"),(o=a.value)==null||o.clearSelection(),(P=a.value)==null||P.getTableList()},u=async i=>{var o;await se(ta,{id:i.id},`重置【${i.username}】用户密码`),(o=a.value)==null||o.getTableList()},h=async i=>{var o;await se(ea,{id:i.id,status:i.status==1?0:1},`切换【${i.username}】用户状态`),(o=a.value)==null||o.getTableList()},_=async()=>{Te.confirm("确认导出用户数据?","温馨提示",{type:"warning"}).then(()=>{var i;return ze(ke,"用户列表",(i=a.value)==null?void 0:i.searchParam)})},V=A(null),U=()=>{var o,P;const i={title:"用户",tempApi:ke,importApi:Qt,getTableList:(o=a.value)==null?void 0:o.getTableList};(P=V.value)==null||P.acceptParams(i)},$=A(null),B=(i,o={})=>{var M,x;const P={title:i,isView:i==="查看",row:{...o},api:i==="新增"?qt:i==="编辑"?Jt:void 0,getTableList:(M=a.value)==null?void 0:M.getTableList};(x=$.value)==null||x.acceptParams(P)};return(i,o)=>{const P=S("el-button"),M=dt("auth");return C(),H("div",na,[f(Xt,{ref_key:"proTable",ref:a,columns:e,"request-api":n,"init-param":p,"data-callback":t,onDragSort:s},{tableHeader:c(x=>[le((C(),N(P,{type:"primary",icon:k(mt),onClick:o[0]||(o[0]=j=>B("新增"))},{default:c(()=>o[3]||(o[3]=[D("新增用户")])),_:1},8,["icon"])),[[M,"add"]]),le((C(),N(P,{type:"primary",icon:k(vt),plain:"",onClick:U},{default:c(()=>o[4]||(o[4]=[D("批量添加用户")])),_:1},8,["icon"])),[[M,"batchAdd"]]),le((C(),N(P,{type:"primary",icon:k(Be),plain:"",onClick:_},{default:c(()=>o[5]||(o[5]=[D("导出用户数据")])),_:1},8,["icon"])),[[M,"export"]]),f(P,{type:"primary",plain:"",onClick:r},{default:c(()=>o[6]||(o[6]=[D("To 子集详情页面")])),_:1}),f(P,{type:"danger",icon:k(be),plain:"",disabled:!x.isSelected,onClick:j=>g(x.selectedListIds)},{default:c(()=>o[7]||(o[7]=[D(" 批量删除用户 ")])),_:2},1032,["icon","disabled","onClick"])]),expand:c(x=>[D(Q(x.row),1)]),usernameHeader:c(x=>[f(P,{type:"primary",onClick:o[1]||(o[1]=j=>k(J).success("我是通过作用域插槽渲染的表头"))},{default:c(()=>[D(Q(x.column.label),1)]),_:2},1024)]),createTime:c(x=>[f(P,{type:"primary",link:"",onClick:o[2]||(o[2]=j=>k(J).success("我是通过作用域插槽渲染的内容"))},{default:c(()=>[D(Q(x.row.createTime),1)]),_:2},1024)]),operation:c(x=>[f(P,{type:"primary",link:"",icon:k(pt),onClick:j=>B("查看",x.row)},{default:c(()=>o[8]||(o[8]=[D("查看")])),_:2},1032,["icon","onClick"]),f(P,{type:"primary",link:"",icon:k(ft),onClick:j=>B("编辑",x.row)},{default:c(()=>o[9]||(o[9]=[D("编辑")])),_:2},1032,["icon","onClick"]),f(P,{type:"primary",link:"",icon:k(Ve),onClick:j=>u(x.row)},{default:c(()=>o[10]||(o[10]=[D("重置密码")])),_:2},1032,["icon","onClick"]),f(P,{type:"primary",link:"",icon:k(be),onClick:j=>v(x.row)},{default:c(()=>o[11]||(o[11]=[D("删除")])),_:2},1032,["icon","onClick"])]),_:1},8,["columns","init-param"]),f(bt,{ref_key:"drawerRef",ref:$},null,512),f(Zt,{ref_key:"dialogRef",ref:V},null,512)])}}});export{ca as default};
